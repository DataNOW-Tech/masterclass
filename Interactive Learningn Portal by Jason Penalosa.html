<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PUP - Interactive Learning Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" xintegrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoVBL5gI9kLmbG0CsdC3aJheDC_F3A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" xintegrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f5; /* Zinc 100 */
        }
        /* PUP Brand Colors */
        :root {
            --pup-maroon: #7b2124;
            --pup-gold: #ffd700;
        }
        .bg-pup-maroon { background-color: var(--pup-maroon); }
        .text-pup-maroon { color: var(--pup-maroon); }
        .border-pup-maroon { border-color: var(--pup-maroon); }
        .bg-pup-gold { background-color: var(--pup-gold); }
        .text-pup-gold { color: var(--pup-gold); }
        
        /* Slide transition */
        .slide {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .slide.active {
            display: block;
            opacity: 1;
        }
        .student-tip {
            background-color: #eff6ff; /* Blue 50 */
            border-left: 4px solid #3b82f6; /* Blue 500 */
        }
        .answer-span {
            display: none;
            background-color: #fefce8; /* Yellow 50 */
            padding: 2px 8px;
            border-radius: 6px;
            font-weight: 600;
            color: #ca8a04; /* Yellow 600 */
        }
        /* For PDF Exporting */
        #pdf-loader {
            background-color: rgba(0,0,0,0.7);
        }
        .loader {
            border-top-color: var(--pup-maroon);
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }
        @-webkit-keyframes spinner {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">
    <!-- Header -->
    <header class="bg-pup-maroon shadow-md sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 sm:py-4 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div>
                    <h1 class="text-xl sm:text-2xl md:text-3xl font-bold text-white tracking-wider">Polytechnic University of the Philippines</h1>
                    <p class="text-sm sm:text-md md:text-base text-gray-200">Interactive Learning Portal by Jason Penalosa</p>
                </div>
            </div>
            <button id="go-back-btn" class="hidden bg-white text-pup-maroon font-bold py-2 px-3 rounded-lg hover:bg-gray-200 transition-colors flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8
 0 100-16 8 8 0 000 16zm.707-10.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L9.414 11H13a1 1 0 100-2H9.414l1.293-1.293z" clip-rule="evenodd" />
                </svg>
                <span class="hidden sm:inline">Main Menu</span>
            </button>
        </div>
    </header>

    <!-- Landing Page: Course Selection -->
    <main id="landing-page" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        <div class="text-center mb-10">
            <h2 class="text-2xl sm:text-3xl font-extrabold text-pup-maroon">Welcome, Iskolar ng Bayan!</h2>
            <p class="mt-2 text-md sm:text-lg text-gray-600">Please select your program and section to begin.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Course Cards will be inserted here by JS -->
        </div>
    </main>

    <!-- Password Modal -->
    <div id="password-modal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-2xl p-6 sm:p-8 w-full max-w-md transform transition-all" id="password-modal-content">
            <h3 class="text-xl sm:text-2xl font-bold text-pup-maroon text-center mb-2">Access Required</h3>
            <p class="text-center text-gray-600 mb-6">Enter the passcode for <strong id="selected-course-title" class="text-gray-800"></strong>.</p>
            <input type="password" id="password-input" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-pup-maroon focus:border-pup-maroon transition" placeholder="Enter passcode...">
            <p id="password-error" class="text-red-600 text-sm mt-2 hidden">Invalid passcode. Please try again.</p>
            <button id="submit-password" class="w-full bg-pup-maroon text-white font-bold py-3 px-4 rounded-lg mt-6 hover:bg-opacity-90 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pup-maroon">Enter Lecture Hall</button>
            <button id="cancel-password" class="w-full bg-gray-200 text-gray-700 font-bold py-3 px-4 rounded-lg mt-3 hover:bg-gray-300 transition">Cancel</button>
        </div>
    </div>
    
    <!-- Admin Password Modal for Answers -->
    <div id="admin-password-modal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-2xl p-6 sm:p-8 w-full max-w-sm transform transition-all">
            <h3 class="text-lg sm:text-xl font-bold text-pup-maroon text-center mb-4">Admin Access Required</h3>
            <p class="text-center text-gray-600 mb-6 text-sm">Enter the admin password to reveal the answer.</p>
            <input type="password" id="admin-password-input" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-pup-maroon focus:border-pup-maroon transition" placeholder="Admin passcode...">
            <p id="admin-password-error" class="text-red-600 text-xs mt-2 hidden">Invalid admin passcode.</p>
            <div class="flex space-x-2 mt-6">
                 <button id="cancel-admin-password" class="w-full bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 transition">Cancel</button>
                <button id="submit-admin-password" class="w-full bg-pup-maroon text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition">Reveal</button>
            </div>
        </div>
    </div>
    
    <!-- PDF Loader Modal -->
    <div id="pdf-loader" class="hidden fixed inset-0 z-50 flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg shadow-xl flex flex-col items-center">
            <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-24 w-24 mb-4"></div>
            <h2 class="text-center text-pup-maroon text-xl font-semibold">Generating PDF...</h2>
            <p class="text-center text-gray-600">Please wait, this may take a moment.</p>
        </div>
    </div>

    <!-- Main Content: Dashboard -->
    <div id="main-content" class="hidden max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        <div class="flex flex-col md:flex-row gap-6 md:gap-8">
            <!-- Sidebar Navigation -->
            <aside class="w-full md:w-1/4 lg:w-1/5">
                <div class="bg-white rounded-lg shadow p-4 sticky top-24 md:top-28">
                    <h3 id="course-sidebar-title" class="text-xl font-bold text-pup-maroon mb-4 border-b-2 border-gray-200 pb-2">COMP 001</h3>
                    <nav id="sidebar-nav" class="space-y-2">
                        <!-- Nav items will be inserted here by JS -->
                    </nav>
                    <div id="sidebar-export-section" class="hidden pt-4 mt-4 border-t-2 border-gray-200">
                        <!-- Export button will be inserted here -->
                    </div>
                </div>
            </aside>

            <!-- Content Area -->
            <section id="content-area" class="w-full md:w-3/4 lg:w-4/5">
                <!-- Content will be dynamically loaded here -->
            </section>
        </div>
    </div>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DATA ---
        const ADMIN_PASSWORD = 'PUPADMIN24';
        const courses = {
            'DIT 1-1 / COMP001': { title: 'Introduction to Computing', code: 'COMP001', password: 'DIT11COMP1' },
            'DIT 1-1 / COMP002': { title: 'Computer Programming 1', code: 'COMP002', password: 'DIT11COMP2' },
            'IT 1-1 / COMP001': { title: 'Introduction to Computing', code: 'COMP001', password: 'IT11COMP1' },
            'IT 1-2 / COMP001': { title: 'Introduction to Computing', code: 'COMP001', password: 'IT12COMP1' },
            'IT 2-1 / COMP006': { title: 'Data Structures and Algorithms', code: 'COMP006', password: 'IT21COMP6' },
        };
        
        let activeSlide = 0;
        let slides = [];
        let currentCourse = null;
        let questionToReveal = null;

        const content = {
            'COMP001': {
                'grading-system': {
                    title: 'Grading System',
                    html: `
                        <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg animate-fade-in">
                            <h2 class="text-2xl sm:text-3xl font-black text-pup-maroon mb-6 border-b-4 border-pup-maroon pb-3">Course Grading System</h2>
                            <p class="text-gray-700 mb-8 text-md sm:text-lg">Your final grade is a reflection of your consistent effort throughout the semester. It's calculated based on your performance in class activities and major examinations.</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 mb-10">
                                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-pup-maroon"><h3 class="text-xl sm:text-2xl font-bold text-gray-800">Class Standing</h3><p class="text-4xl sm:text-5xl font-extrabold text-pup-maroon mt-2">70%</p><ul class="mt-4 text-gray-600 list-disc list-inside space-y-2"><li>Quizzes & Exercises</li><li>Assignments</li><li>Recitation / Participation</li><li>Portfolio / Projects</li></ul></div>
                                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-pup-gold"><h3 class="text-xl sm:text-2xl font-bold text-gray-800">Major Examinations</h3><p class="text-4xl sm:text-5xl font-extrabold text-pup-maroon mt-2">30%</p><ul class="mt-4 text-gray-600 list-disc list-inside space-y-2"><li>Midterm Examination</li><li>Final Examination</li></ul></div>
                            </div>
                            <div class="mb-10"><h3 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Final Grade Calculation</h3><div class="bg-pup-maroon text-white p-4 rounded-lg text-center font-mono text-md sm:text-lg shadow-inner">(Midterm Grade + Final Term Grade) / 2 = Final Grade</div></div>
                            <h3 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4">Grade Equivalents</h3>
                            <div class="overflow-x-auto"><table class="min-w-full bg-white border border-gray-200 rounded-lg shadow"><thead class="bg-pup-maroon text-white"><tr><th class="text-left py-3 px-4 uppercase font-semibold text-sm">Grade/Mark</th><th class="text-left py-3 px-4 uppercase font-semibold text-sm">Percentage / Equivalence</th><th class="text-left py-3 px-4 uppercase font-semibold text-sm">Description</th></tr></thead><tbody class="text-gray-700"><tr class="border-b"><td class="py-3 px-4">1.0</td><td class="py-3 px-4">97-100</td><td class="py-3 px-4 font-semibold text-green-700">Excellent</td></tr><tr class="bg-gray-50 border-b"><td class="py-3 px-4">1.25</td><td class="py-3 px-4">94-96</td><td class="py-3 px-4 font-semibold text-green-700">Excellent</td></tr><tr class="border-b"><td class="py-3 px-4">1.50</td><td class="py-3 px-4">91-93</td><td class="py-3 px-4 font-semibold text-blue-700">Very Good</td></tr><tr class="bg-gray-50 border-b"><td class="py-3 px-4">1.75</td><td class="py-3 px-4">88-90</td><td class="py-3 px-4 font-semibold text-blue-700">Very Good</td></tr><tr class="border-b"><td class="py-3 px-4">2.0</td><td class="py-3 px-4">85-87</td><td class="py-3 px-4 font-semibold text-cyan-700">Good</td></tr><tr class="bg-gray-50 border-b"><td class="py-3 px-4">2.25</td><td class="py-3 px-4">82-84</td><td class="py-3 px-4 font-semibold text-cyan-700">Good</td></tr><tr class="border-b"><td class="py-3 px-4">2.50</td><td class="py-3 px-4">79-81</td><td class="py-3 px-4">Satisfactory</td></tr><tr class="bg-gray-50 border-b"><td class="py-3 px-4">2.75</td><td class="py-3 px-4">76-78</td><td class="py-3 px-4">Satisfactory</td></tr><tr class="border-b"><td class="py-3 px-4">3.0</td><td class="py-3 px-4">75</td><td class="py-3 px-4 font-semibold text-orange-600">Passing</td></tr><tr class="bg-red-50"><td class="py-3 px-4 font-bold text-red-700">5.0</td><td class="py-3 px-4 font-bold text-red-700">Below 75</td><td class="py-3 px-4 font-bold text-red-700">Failure</td></tr></tbody></table></div>
                        </div>`
                },
                'course-outline': {
                    title: 'Course Outline',
                    html: `
                        <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                            <h2 class="text-2xl sm:text-3xl font-black text-pup-maroon mb-6 border-b-4 border-pup-maroon pb-3">Weekly Course Outline</h2>
                            <div class="space-y-4">
                                ${[ { week: '1-2', topic: 'The Grand Tour: Introduction to Computers and Computing', details: 'Defining computers, a whirlwind tour of computing history, and meeting the different types of computers.' }, { week: '3', topic: 'Anatomy of a PC: Computer Hardware', details: 'Exploring the essential components: CPU, Motherboard, RAM, Storage, and I/O devices.' }, { week: '4', topic: 'The Ghost in the Machine: Computer Software', details: 'Differentiating between system and application software, with hands-on installation.' }, { week: '5', topic: 'The Conductor: Operating Systems', details: 'Understanding the role of an OS, comparing Windows, macOS, and Linux, and learning basic commands.' } ].map(item => `<div class="p-4 border rounded-lg hover:shadow-md transition bg-gray-50"><div class="flex items-start sm:items-center flex-col sm:flex-row"><span class="bg-pup-maroon text-white text-sm font-bold px-3 py-1 rounded-full mr-4 mb-2 sm:mb-0">Week ${item.week}</span><h3 class="text-lg font-bold text-gray-800">${item.topic}</h3></div><p class="text-gray-600 mt-2 pl-4 border-l-2 border-gray-200">${item.details}</p></div>`).join('')}
                            </div>
                        </div>`
                },
                'week-1': {
                    title: 'Week 1: Intro to Computing',
                    slides: [
                        { title: "Welcome to the Digital Universe!", content: `<h3 class="text-3xl sm:text-4xl font-black text-pup-maroon">Let's Begin Our Journey!</h3><p class="mt-4 text-lg sm:text-xl text-gray-700">Think about your day so far. Did you use a phone? Watch TV? Travel in a car? If so, you've already interacted with several computers. This course is about understanding these incredible machines, from the giant supercomputers to the tiny chips in your microwave.</p><p class="mt-4 text-md sm:text-lg text-gray-700">Our goal isn't just to learn facts, but to understand the 'why' and 'how' behind the technology that powers our modern world.</p><div class="mt-8 student-tip p-4 rounded-lg"><p class="font-bold text-blue-800">Student Tip:</p><p class="text-blue-700">Stay curious! The best way to learn about technology is to ask questions. If you wonder "how does that work?", you're on the right track!</p></div>`},
                        { title: "What is a Computer?", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">At its heart, a computer is a machine that follows instructions. We can give it some data (<strong>Input</strong>), it will think about it (<strong>Process</strong>), show us the result (<strong>Output</strong>), and maybe save it for later (<strong>Storage</strong>).</p><p class="text-md sm:text-lg text-gray-700 mb-6">Let's tell a story using this <strong>IPOS Cycle</strong>. Imagine you're writing an essay:</p><ul class="space-y-3 text-md sm:text-base"><li><strong class="text-blue-600">INPUT:</strong> You type letters on your keyboard. That's the input.</li><li><strong class="text-green-600">PROCESS:</strong> The computer's processor arranges these letters into words and sentences. It checks for spelling errors. That's the processing.</li><li><strong class="text-purple-600">OUTPUT:</strong> The words appear on your monitor. That's the output.</li><li><strong class="text-yellow-600">STORAGE:</strong> You click 'Save'. The computer writes your essay file to the hard drive. That's storage.</li></ul>`},
                        { title: "Hardware vs. Software", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Every computer system has two fundamental parts. A simple way to think about it is:</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-center"><div class="bg-gray-100 p-6 rounded-lg"><h4 class="text-2xl font-bold text-pup-maroon">Hardware</h4><p class="mt-2 text-gray-600">The physical parts of the computer you can touch. The keyboard, mouse, monitor, and the circuits inside the case.</p><p class="mt-4 font-semibold text-lg">It's the Body.</p></div><div class="bg-gray-100 p-6 rounded-lg"><h4 class="text-2xl font-bold text-pup-maroon">Software</h4><p class="mt-2 text-gray-600">The set of instructions (programs) that tells the hardware what to do. Your operating system (Windows, macOS), web browser, and games.</p><p class="mt-4 font-semibold text-lg">It's the Mind.</p></div></div><div class="mt-8 student-tip p-4 rounded-lg"><p class="font-bold text-blue-800">Key Concept:</p><p class="text-blue-700">Hardware is useless without software to run it, and software can't do anything without hardware to run on. They need each other to function.</p></div>`},
                        { title: "The Language of Computers", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">How do computers, which are just circuits and electricity, understand things like letters, photos, and videos? The secret is a simple language called <strong class="text-pup-maroon">Binary Code</strong>.</p><p class="text-md sm:text-lg text-gray-700">Computers only understand two states: <strong>ON</strong> or <strong>OFF</strong>. We represent these states with numbers: <strong>1 (ON)</strong> and <strong>0 (OFF)</strong>. Each 1 or 0 is called a 'bit'.</p><p class="text-md sm:text-lg text-gray-700 mt-4">By combining these bits in long strings, computers can represent everything! For example:</p><div class="font-mono text-center bg-gray-800 text-white p-4 rounded-lg mt-4 text-sm sm:text-base">The letter 'A' might be <span class="text-green-400">01000001</span><br>The number '5' might be <span class="text-green-400">00000101</span></div>`},
                        { title: "A Brief History of Computing", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">The idea of a 'computer' is older than electricity! Let's trace the story.</p><ul class="list-disc list-inside space-y-2 text-gray-800 text-sm sm:text-base"><li><strong>Ancient Times:</strong> The Abacus was an early form of a calculating tool.</li><li><strong>1800s:</strong> Charles Babbage designed the Analytical Engine, a mechanical computer. Ada Lovelace wrote the first algorithm for it, making her the first programmer!</li><li><strong>1940s:</strong> The first electronic computers were built, like ENIAC. They were massive, filled entire rooms, and used vacuum tubes.</li><li><strong>1950s-60s:</strong> The invention of the transistor made computers smaller, faster, and more reliable.</li><li><strong>1970s:</strong> The microprocessor put an entire computer brain on a single chip, leading to the first personal computers (PCs).</li><li><strong>1980s-90s:</strong> Companies like Apple and Microsoft brought computers into our homes, and the World Wide Web was born.</li><li><strong>2000s-Today:</strong> The rise of smartphones, cloud computing, and AI puts powerful computing in the palm of our hands.</li></ul>`},
                        { title: "Generations of Computers", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">We often group computers into 'generations' based on their core technology. Each generation brought a massive leap in power and a huge reduction in size.</p><div class="space-y-3 text-md sm:text-base"><p><strong>1st Gen (Vacuum Tubes):</strong> Massive, hot, and unreliable.</p><p><strong>2nd Gen (Transistors):</strong> Smaller, cooler, and more dependable.</p><p><strong>3rd Gen (Integrated Circuits):</strong> Many transistors on one chip. Cheaper and more powerful.</p><p><strong>4th Gen (Microprocessors):</strong> A whole CPU on one chip. The age of the PC begins!</p><p><strong>5th Gen (AI & Parallel Processing):</strong> What we have today and are developing for the future, focusing on artificial intelligence and connecting many processors.</p></div>`},
                        { title: "The Computer Family Tree", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Computers are not one-size-fits-all. They come in many forms, each designed for a specific job.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-bold text-pup-maroon">Supercomputers:</h4><p class="text-sm text-gray-600">The fastest computers on Earth, used for weather forecasting and scientific research.</p></div><div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-bold text-pup-maroon">Mainframes:</h4><p class="text-sm text-gray-600">Handle huge amounts of transactions for banks and airlines.</p></div><div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-bold text-pup-maroon">Servers:</h4><p class="text-sm text-gray-600">The backbone of the internet, hosting websites and managing data.</p></div><div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-bold text-pup-maroon">Personal Computers (PCs):</h4><p class="text-sm text-gray-600">Desktops and laptops for our daily work and play.</p></div><div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-bold text-pup-maroon">Mobile Devices:</h4><p class="text-sm text-gray-600">Smartphones and tablets that have become our primary computing devices.</p></div><div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-bold text-pup-maroon">Embedded Systems:</h4><p class="text-sm text-gray-600">Hidden computers in cars, TVs, and appliances that perform one specific task.</p></div></div>`},
                        { title: "A Day in Your Life with Computers", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Let's trace the hidden computers in a typical student's day.</p><p class="text-md sm:text-lg text-gray-700">You wake up to an alarm on your <strong class="text-pup-maroon">smartphone</strong> (1). You check social media. You go to the kitchen, and the <strong class="text-pup-maroon">microwave</strong> (2) heats your breakfast. You ride a jeep or bus, paying with a card read by a <strong class="text-pup-maroon">payment terminal</strong> (3). The traffic lights are controlled by a <strong class="text-pup-maroon">computer system</strong> (4). At school, you use a <strong class="text-pup-maroon">PC</strong> (5) in the library. After school, you watch a show on a <strong class="text-pup-maroon">Smart TV</strong> (6).</p><p class="mt-4 text-md sm:text-lg">Computers are everywhere, making our lives easier, safer, and more connected. They are the invisible engines of our society.</p>`},
                        { title: "Let's Review: Week 1", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Let's recap the big ideas from this week!</p><ul class="list-decimal list-inside space-y-3 text-md sm:text-lg text-gray-800"><li>A computer works on the <strong class="text-pup-maroon">IPOS</strong> (Input, Process, Output, Storage) cycle.</li><li>A computer system is made of <strong class="text-pup-maroon">Hardware</strong> (the body) and <strong class="text-pup-maroon">Software</strong> (the mind).</li><li>Computers speak <strong class="text-pup-maroon">Binary</strong>, a language of 1s (ON) and 0s (OFF).</li><li>Computer history progressed through five generations, getting smaller and more powerful each time.</li><li>There are many types of computers, from giant <strong class="text-pup-maroon">Supercomputers</strong> to tiny <strong class="text-pup-maroon">Embedded Systems</strong>.</li></ul>`},
                        { 
                            title: "Week 1 Exercises", 
                            exercises: [
                                { q: "The physical parts of a computer are called ______.", a: "Hardware" },
                                { q: "The 'P' in the IPOS cycle stands for ______.", a: "Process" },
                                { q: "What are the two digits used in binary code?", a: "0 and 1" },
                                { q: "The programs and instructions that run on a computer are called ______.", a: "Software" },
                                { q: "What technology was used in First Generation computers?", a: "Vacuum Tubes" },
                                { q: "A computer hidden inside a car or a microwave is an example of an ______ system.", a: "Embedded" },
                                { q: "Who is considered the first computer programmer?", a: "Ada Lovelace" },
                                { q: "Your smartphone is a type of ______ device.", a: "Mobile" },
                                { q: "The 'brain' of the computer that processes data is part of which IPOS stage?", a: "Process" },
                                { q: "What invention led to the Fourth Generation of computers and the PC?", a: "Microprocessor" }
                            ]
                        }
                    ]
                },
                'week-2': {
                    title: 'Week 2: Computer Hardware',
                    slides: [
                        { title: "Anatomy of a Digital Beast", content: `<h3 class="text-3xl sm:text-4xl font-black text-pup-maroon">Let's Open the Box!</h3><p class="mt-4 text-lg sm:text-xl text-gray-700">Last week, we learned what a computer IS. This week, we're taking one apart (figuratively!) to see what's inside. We are exploring the world of <strong class="text-pup-maroon">Hardware</strong> – the collection of physical components that work together to bring your computer to life.</p><p class="mt-4 text-md sm:text-lg text-gray-700">Think of it like being a mechanic, but instead of an engine, we're looking at a motherboard.</p>` },
                        { title: "The Motherboard: The PC's Main Hub", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Everything connects to the <strong class="text-pup-maroon">Motherboard</strong>. It's the foundation of the computer, a large circuit board that lets all the other parts communicate. It's like the map of a city, with roads connecting all the important buildings.</p><p class="text-md sm:text-lg font-semibold text-gray-800">Key parts of a motherboard:</p><ul class="list-disc list-inside space-y-2 mt-2 text-gray-700 text-sm sm:text-base"><li><strong>CPU Socket:</strong> Where the 'brain' is installed.</li><li><strong>RAM Slots:</strong> Where the short-term memory sticks are inserted.</li><li><strong>PCIe Slots:</strong> For expansion cards like graphics cards.</li><li><strong>SATA Ports:</strong> To connect storage drives like SSDs and HDDs.</li><li><strong>I/O Panel:</strong> The ports on the back of your PC (USB, HDMI, etc.).</li></ul>` },
                        { title: "The CPU: The Brains of the Operation", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">The <strong class="text-pup-maroon">Central Processing Unit (CPU)</strong> is a small chip that is the engine of your computer. It executes billions of instructions per second to run your programs.</p><p class="text-md sm:text-lg text-gray-700">Imagine a chef in a kitchen. The recipe is the program, and the chef (CPU) reads each instruction and performs the action (chops vegetables, stirs the pot). The faster the chef, the quicker the meal is ready.</p><div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"><div class="bg-gray-50 p-4 rounded-lg"><strong>Clock Speed (GHz):</strong> How many cycles (instructions) it can run per second. Higher is generally better.</div><div class="bg-gray-50 p-4 rounded-lg"><strong>Cores:</strong> The number of independent processors on the chip. More cores means it can multitask better (like having multiple chefs).</div></div>` },
                        { title: "RAM: The High-Speed Workspace", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6"><strong class="text-pup-maroon">Random Access Memory (RAM)</strong> is your computer's short-term memory. It's where the computer temporarily stores the data for the applications you are currently running.</p><p class="text-md sm:text-lg text-gray-700">Think of it as your desk. When you work on a project, you take your books and papers (data) out of your cabinet (storage) and put them on your desk (RAM) to access them quickly. When you're done, you put them back. If the power goes out, your desk is cleared!</p><div class="mt-6 student-tip p-4 rounded-lg"><p class="font-bold text-blue-800">Key Concept:</p><p class="text-blue-700">RAM is <strong class="font-semibold">volatile</strong>, meaning it needs power to hold data. More RAM allows you to run more applications smoothly at the same time.</p></div>` },
                        { title: "Storage: Long-Term Memory", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">This is where your files, operating system, and programs are kept permanently. Unlike RAM, storage is <strong class="text-pup-maroon">non-volatile</strong> – it keeps your data even when the power is off.</p><p class="text-md sm:text-lg font-semibold text-gray-800">The two main types are:</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4"><div class="bg-gray-100 p-4 rounded-lg"><h4 class="font-bold text-xl">HDD (Hard Disk Drive)</h4><p class="text-sm mt-2">Uses a spinning platter and a mechanical arm to read/write data. Think of a record player. It's slower, but offers more storage for less money.</p></div><div class="bg-gray-100 p-4 rounded-lg"><h4 class="font-bold text-xl">SSD (Solid-State Drive)</h4><p class="text-sm mt-2">Uses flash memory chips with no moving parts. It's like a very large, very fast USB drive. Your computer boots up and opens programs much faster with an SSD.</p></div></div>` },
                        { title: "The GPU: Powering Your Pixels", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">The <strong class="text-pup-maroon">Graphics Processing Unit (GPU)</strong>, or graphics card, is a specialized processor designed to handle everything you see on your screen. While a CPU has a few powerful cores, a GPU has thousands of simpler cores that work together.</p><p class="text-md sm:text-lg text-gray-700">It's the difference between a master artist (CPU) painting one masterpiece, and an army of painters (GPU) each painting one pixel at the same time. This is why GPUs are essential for:</p><ul class="list-disc list-inside space-y-2 mt-4 text-gray-800"><li>Video Games</li><li>Video Editing and Animation</li><li>Scientific Simulations and AI</li></ul>` },
                        { title: "Peripherals & Ports", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Peripherals are the devices we connect to the outside of the computer case. They plug into <strong class="text-pup-maroon">Ports</strong>, which are the connection points on the motherboard's I/O panel.</p><p class="text-md sm:text-lg font-semibold text-gray-800">Common Ports:</p><ul class="list-disc list-inside space-y-2 mt-2 text-gray-700 text-sm sm:text-base"><li><strong>USB (Universal Serial Bus):</strong> The most common port for connecting mice, keyboards, printers, phones, and flash drives. (Types: USB-A, USB-C)</li><li><strong>HDMI/DisplayPort:</strong> Used to connect your monitor or a TV.</li><li><strong>Ethernet Port:</strong> For a wired internet connection.</li><li><strong>Audio Jacks:</strong> For connecting speakers, headphones, and microphones.</li></ul>` },
                        { title: "Keeping It Cool", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Computer components, especially the CPU and GPU, generate a lot of heat when they work hard. If they get too hot, they slow down or can even be damaged. That's why every PC needs a cooling system.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4"><div class="bg-gray-100 p-4 rounded-lg"><h4 class="font-bold text-xl">Fans</h4><p class="text-sm mt-2">Case fans pull cool air in and push hot air out. The CPU and GPU have their own dedicated fans.</p></div><div class="bg-gray-100 p-4 rounded-lg"><h4 class="font-bold text-xl">Heatsinks</h4><p class="text-sm mt-2">A block of metal with many fins that sits on top of the CPU. It absorbs the heat, and the fins provide a large surface area for the fan to blow the heat away.</p></div></div>` },
                        { title: "Let's Review: Week 2", content: `<p class="text-lg sm:text-xl text-gray-700 mb-6">Let's recap the key hardware components!</p><ul class="list-decimal list-inside space-y-3 text-md sm:text-lg text-gray-800"><li>The <strong class="text-pup-maroon">Motherboard</strong> is the central hub connecting all parts.</li><li>The <strong class="text-pup-maroon">CPU</strong> is the brain that executes instructions.</li><li><strong class="text-pup-maroon">RAM</strong> is the fast, temporary workspace (volatile memory).</li><li><strong class="text-pup-maroon">Storage (SSD/HDD)</strong> is the slow, permanent home for your files (non-volatile).</li><li>The <strong class="text-pup-maroon">GPU</strong> is a special processor for handling graphics and visuals.</li><li><strong class="text-pup-maroon">Ports</strong> like USB and HDMI allow us to connect external devices.</li></ul>` },
                        { 
                            title: "Week 2 Exercises", 
                            exercises: [
                                { q: "What is the main circuit board that connects everything called?", a: "Motherboard" },
                                { q: "Is RAM volatile or non-volatile?", a: "Volatile" },
                                { q: "Which is faster, an SSD or an HDD?", a: "SSD" },
                                { q: "The 'brain' of the computer is the ______.", a: "CPU" },
                                { q: "What type of port would you use to connect a monitor?", a: "HDMI or DisplayPort" },
                                { q: "The number of processors on a single CPU chip is measured in ______.", a: "Cores" },
                                { q: "What component is most important for playing high-end video games?", a: "GPU (Graphics Card)" },
                                { q: "What part converts power from the wall outlet for the computer to use?", a: "PSU (Power Supply Unit)" },
                                { q: "A keyboard is an example of an ______ device.", a: "Input" },
                                { q: "What does RAM stand for?", a: "Random Access Memory" }
                            ]
                        }
                    ]
                },
                'references': {
                    title: 'References',
                    html: `
                        <div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
                            <h2 class="text-2xl sm:text-3xl font-black text-pup-maroon mb-6 border-b-4 border-pup-maroon pb-3">References & Further Reading</h2>
                            <ul class="list-disc list-inside space-y-3 text-gray-700">
                                <li>Floyd, Thomas L. (205). <em>Digital Fundamentals: A Systems Approach.</em> Pearson Education Limited.</li>
                                <li>Matthes, Eric. (2019). <em>Python Crash Course: A Hands-On, Project-based Introduction to Programming.</em></li>
                                <li>GCFGlobal. (n.d.). <em>Computer Basics.</em> Retrieved from https://edu.gcfglobal.org/en/computerbasics/</li>
                                <li>TutorialsPoint. (n.d.). <em>Computer Fundamentals Tutorial.</em> Retrieved from https://www.tutorialspoint.com/computer_fundamentals/index.htm</li>
                            </ul>
                        </div>`
                }
            }
        };

        // --- ELEMENTS ---
        const goBackBtn = document.getElementById('go-back-btn');
        const landingPage = document.getElementById('landing-page');
        const courseGrid = landingPage.querySelector('.grid');
        const passwordModal = document.getElementById('password-modal');
        const passwordModalContent = document.getElementById('password-modal-content');
        const passwordInput = document.getElementById('password-input');
        const passwordError = document.getElementById('password-error');
        const selectedCourseTitle = document.getElementById('selected-course-title');
        const submitPasswordBtn = document.getElementById('submit-password');
        const cancelPasswordBtn = document.getElementById('cancel-password');
        const mainContent = document.getElementById('main-content');
        const contentArea = document.getElementById('content-area');
        const sidebarNav = document.getElementById('sidebar-nav');
        const sidebarExportSection = document.getElementById('sidebar-export-section');
        const courseSidebarTitle = document.getElementById('course-sidebar-title');
        const pdfLoader = document.getElementById('pdf-loader');

        const adminPasswordModal = document.getElementById('admin-password-modal');
        const adminPasswordInput = document.getElementById('admin-password-input');
        const adminPasswordError = document.getElementById('admin-password-error');
        const submitAdminPasswordBtn = document.getElementById('submit-admin-password');
        const cancelAdminPasswordBtn = document.getElementById('cancel-admin-password');
        
        // --- FUNCTIONS ---

        function init() {
            populateCourseCards();
            cancelPasswordBtn.addEventListener('click', hidePasswordModal);
            submitPasswordBtn.addEventListener('click', checkPassword);
            goBackBtn.addEventListener('click', goToMainMenu);
            passwordInput.addEventListener('keyup', (e) => { if(e.key === 'Enter') checkPassword(); });

            cancelAdminPasswordBtn.addEventListener('click', hideAdminPasswordModal);
            submitAdminPasswordBtn.addEventListener('click', checkAdminPasswordForAnswer);
            adminPasswordInput.addEventListener('keyup', (e) => { if(e.key === 'Enter') checkAdminPasswordForAnswer(); });
        }

        function populateCourseCards() {
            courseGrid.innerHTML = '';
            for (const key in courses) {
                const course = courses[key];
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow-md p-6 flex flex-col items-center text-center cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300';
                card.dataset.key = key;
                card.innerHTML = `<div class="bg-pup-maroon rounded-full p-4 mb-4"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div><h3 class="text-xl font-bold text-gray-800">${course.title}</h3><p class="text-gray-500">${key.split('/')[0].trim()}</p><span class="mt-4 bg-pup-gold text-pup-maroon text-xs font-bold px-3 py-1 rounded-full">${course.code}</span>`;
                card.addEventListener('click', () => handleCourseSelection(key));
                courseGrid.appendChild(card);
            }
        }
        
        function handleCourseSelection(key) {
            currentCourse = { key, ...courses[key] };
            selectedCourseTitle.textContent = `${currentCourse.title} (${key.split('/')[0].trim()})`;
            showPasswordModal();
        }

        function showPasswordModal() {
            passwordModal.classList.remove('hidden');
            setTimeout(() => passwordModalContent.classList.add('scale-100'), 50);
            passwordInput.value = '';
            passwordError.classList.add('hidden');
            passwordInput.focus();
        }

        function hidePasswordModal() {
            passwordModalContent.classList.remove('scale-100');
            passwordModal.classList.add('hidden');
        }
        
        function showAdminPasswordModal(questionId) {
            questionToReveal = questionId;
            adminPasswordModal.classList.remove('hidden');
            adminPasswordInput.value = '';
            adminPasswordError.classList.add('hidden');
            adminPasswordInput.focus();
        }

        function hideAdminPasswordModal() {
            adminPasswordModal.classList.add('hidden');
            questionToReveal = null;
        }

        function checkPassword() {
            const enteredPassword = passwordInput.value.trim();
            if (enteredPassword === currentCourse.password || enteredPassword === ADMIN_PASSWORD) {
                launchDashboard();
            } else {
                passwordError.classList.remove('hidden');
                passwordInput.classList.add('border-red-500');
                setTimeout(() => {
                    passwordError.classList.add('hidden');
                    passwordInput.classList.remove('border-red-500');
                }, 3000);
            }
        }
        
        function checkAdminPasswordForAnswer() {
            const enteredPassword = adminPasswordInput.value.trim();
            if (enteredPassword === ADMIN_PASSWORD) {
                const answerSpan = document.getElementById(`answer-${questionToReveal}`);
                const answerButton = document.getElementById(`button-${questionToReveal}`);
                if (answerSpan) {
                    answerSpan.style.display = 'inline';
                    answerButton.style.display = 'none';
                }
                hideAdminPasswordModal();
            } else {
                adminPasswordError.classList.remove('hidden');
                setTimeout(() => {
                    adminPasswordError.classList.add('hidden');
                }, 2000);
            }
        }
        
        function launchDashboard() {
            hidePasswordModal();
            landingPage.classList.add('hidden');
            mainContent.classList.remove('hidden');
            goBackBtn.classList.remove('hidden');
            
            const courseContent = content[currentCourse.code];
            if (!courseContent) {
                contentArea.innerHTML = `<div class="bg-white p-8 rounded-xl shadow-lg text-center"><h2 class="text-2xl font-bold text-pup-maroon">Content Coming Soon!</h2><p class="mt-2 text-gray-600">Lecture materials for ${currentCourse.title} are under development.</p></div>`;
                sidebarNav.innerHTML = '';
                courseSidebarTitle.textContent = currentCourse.code;
                return;
            }
            populateSidebar(courseContent);
            loadContent('grading-system');
        }

        function goToMainMenu() {
            mainContent.classList.add('hidden');
            goBackBtn.classList.add('hidden');
            landingPage.classList.remove('hidden');
            currentCourse = null;
        }

        function populateSidebar(courseContent) {
            courseSidebarTitle.textContent = currentCourse.code;
            sidebarNav.innerHTML = '';
            Object.keys(courseContent).forEach(key => {
                const navItem = document.createElement('a');
                navItem.href = '#';
                navItem.dataset.contentId = key;
                navItem.className = 'block px-4 py-2 rounded-md text-gray-700 hover:bg-gray-200 hover:text-pup-maroon font-medium transition';
                navItem.textContent = courseContent[key].title;
                if(key === 'grading-system') navItem.classList.add('bg-gray-200', 'text-pup-maroon');
                navItem.addEventListener('click', (e) => {
                    e.preventDefault();
                    loadContent(key);
                    sidebarNav.querySelectorAll('a').forEach(a => a.classList.remove('bg-gray-200', 'text-pup-maroon'));
                    navItem.classList.add('bg-gray-200', 'text-pup-maroon');
                });
                sidebarNav.appendChild(navItem);
            });
        }
        
        function loadContent(contentId) {
            const courseContent = content[currentCourse.code];
            const contentData = courseContent[contentId];
            const exportSection = document.getElementById('sidebar-export-section');

            if (contentData.slides) {
                let slidesHtml = contentData.slides.map((slide, index) => {
                    let slideContent = slide.content;
                    if (slide.exercises) {
                         slideContent = `<h3 class="text-2xl font-bold text-pup-maroon mb-6">Let's Answer in Chorus!</h3><div class="text-md sm:text-lg space-y-4 text-gray-800">
                            ${slide.exercises.map((ex, exIndex) => {
                                const questionId = `${contentId}-${exIndex}`;
                                return `<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-2 border-b">
                                            <p class="mb-2 sm:mb-0">${exIndex + 1}. ${ex.q}</p>
                                            <div class="self-end sm:self-center">
                                                <button id="button-${questionId}" data-question-id="${questionId}" class="show-answer-btn text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-1 px-3 rounded-md transition">Show Answer</button>
                                                <span id="answer-${questionId}" class="answer-span">${ex.a}</span>
                                            </div>
                                        </div>`
                            }).join('')}
                         </div>`;
                    }
                    return `<div class="slide ${index === 0 ? 'active' : ''}" data-slide-index="${index}"><h2 class="text-2xl sm:text-3xl font-black text-pup-maroon mb-6">${slide.title}</h2>${slideContent}</div>`;
                }).join('');

                contentArea.innerHTML = `<div class="bg-white p-6 sm:p-8 rounded-xl shadow-lg"><div id="slideshow-container" class="min-h-[450px] overflow-x-auto">${slidesHtml}</div><div class="flex justify-between items-center mt-8 pt-4 border-t"><button id="prev-slide" class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 transition">&larr; Previous</button><div id="slide-indicator" class="text-gray-600 font-semibold text-sm sm:text-base"></div><button id="next-slide" class="bg-pup-maroon text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition">Next &rarr;</button></div></div>`;
                
                setupSlideshow();
                
                exportSection.innerHTML = `<button id="export-pdf-btn" data-lecture-id="${contentId}" class="w-full bg-pup-maroon text-white font-bold py-2 px-4 rounded-lg hover:bg-opacity-90 transition flex items-center justify-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd" /></svg><span>Export to PDF</span></button>`;
                document.getElementById('export-pdf-btn').addEventListener('click', (e) => exportLectureToPdf(e.currentTarget.dataset.lectureId));
                exportSection.classList.remove('hidden');

            } else {
                contentArea.innerHTML = contentData.html;
                exportSection.classList.add('hidden');
                exportSection.innerHTML = '';
            }
        }
        
        async function exportLectureToPdf(lectureId) {
            pdfLoader.classList.remove('hidden');
            const { jsPDF } = window.jspdf;
            const lecture = content[currentCourse.code][lectureId];

            if (!lecture || !lecture.slides) {
                console.error("Lecture or slides not found!");
                pdfLoader.classList.add('hidden');
                return;
            }

            const pdf = new jsPDF({
                orientation: 'landscape',
                unit: 'pt',
                format: 'a4'
            });
            
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = pdf.internal.pageSize.getHeight();
            const margin = 72; // 1 inch = 72 points
            const originalActiveSlide = activeSlide; 

            for (let i = 0; i < slides.length; i++) {
                if (i > 0) {
                    pdf.addPage();
                }

                // Programmatically draw header
                pdf.setFillColor('#7b2124'); // PUP Maroon
                pdf.rect(0, 0, pdfWidth, 60, 'F');
                pdf.setFont('Inter', 'bold');
                pdf.setFontSize(22);
                pdf.setTextColor('#FFFFFF');
                pdf.text('Polytechnic University of the Philippines', pdfWidth / 2, 30, { align: 'center' });
                pdf.setFont('Inter', 'normal');
                pdf.setFontSize(12);
                pdf.setTextColor('#DDDDDD');
                pdf.text('Interactive Learning Portal by Jason Penalosa', pdfWidth / 2, 48, { align: 'center' });
                
                const slideElement = slides[i];
                
                slides.forEach(s => s.classList.remove('active'));
                slideElement.classList.add('active');

                await new Promise(resolve => setTimeout(resolve, 50));

                const canvas = await html2canvas(slideElement, { scale: 2 });
                const imgData = canvas.toDataURL('image/jpeg', 0.9);
                
                if (canvas.width === 0 || canvas.height === 0) {
                    console.error("Skipping slide " + i + " due to rendering issue.");
                    continue;
                }
                
                const contentMarginTop = 60 + 20; // Header height + padding
                const availableWidth = pdfWidth - (margin * 2);
                const availableHeight = pdfHeight - contentMarginTop - margin;
                
                const aspectRatio = canvas.width / canvas.height;
                let imgWidth = availableWidth;
                let imgHeight = imgWidth / aspectRatio;

                if (imgHeight > availableHeight) {
                    imgHeight = availableHeight;
                    imgWidth = imgHeight * aspectRatio;
                }
                
                const x = (pdfWidth - imgWidth) / 2;
                const y = contentMarginTop + (availableHeight - imgHeight) / 2;

                pdf.addImage(imgData, 'JPEG', x, y, imgWidth, imgHeight);
            }
            
            slides.forEach(s => s.classList.remove('active'));
            if (slides[originalActiveSlide]) {
                slides[originalActiveSlide].classList.add('active');
            }
            
            pdf.save(`${currentCourse.code}-${lectureId}.pdf`);
            pdfLoader.classList.add('hidden');
        }


        function setupSlideshow() {
            const slideshowContainer = document.getElementById('slideshow-container');
            slides = slideshowContainer.querySelectorAll('.slide');
            activeSlide = 0;

            const prevBtn = document.getElementById('prev-slide');
            const nextBtn = document.getElementById('next-slide');
            
            prevBtn.addEventListener('click', () => changeSlide(-1));
            nextBtn.addEventListener('click', () => changeSlide(1));
            
            document.querySelectorAll('.show-answer-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const questionId = e.target.dataset.questionId;
                    showAdminPasswordModal(questionId);
                });
            });

            updateSlideIndicator();
        }

        function changeSlide(direction) {
            slides[activeSlide].classList.remove('active');
            activeSlide = (activeSlide + direction + slides.length) % slides.length;
            slides[activeSlide].classList.add('active');
            updateSlideIndicator();
        }

        function updateSlideIndicator() {
            const indicator = document.getElementById('slide-indicator');
            const prevBtn = document.getElementById('prev-slide');
            const nextBtn = document.getElementById('next-slide');

            indicator.textContent = `Slide ${activeSlide + 1} of ${slides.length}`;
            prevBtn.disabled = activeSlide === 0;
            prevBtn.classList.toggle('opacity-50', activeSlide === 0);
            prevBtn.classList.toggle('cursor-not-allowed', activeSlide === 0);
            
            nextBtn.disabled = activeSlide === slides.length - 1;
            nextBtn.classList.toggle('opacity-50', activeSlide === slides.length - 1);
            nextBtn.classList.toggle('cursor-not-allowed', activeSlide === slides.length - 1);
        }
        
        init();
    });
</script>

</body>
</html>

